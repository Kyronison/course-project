# Аналитическая панель для мониторинга гибридных финансовых показателей

Этот проект представляет собой веб-приложение (аналитическую панель), разработанное для мониторинга и анализа гибридных финансовых показателей, объединяющих данные из традиционных финансовых рынков и децентрализованных финансовых систем (DeFi).

## Описание

Панель агрегирует данные из различных источников (например, цены акций и криптовалют через yfinance, Tinkoff API; метрики DeFi типа TVL), рассчитывает ключевые показатели и предоставляет пользователю удобный интерфейс для их визуализации и анализа. Это помогает инвесторам и аналитикам принимать более обоснованные решения в условиях растущей интеграции традиционных и децентрализованных финансов.

## Ключевые возможности

* Сбор исторических данных по ценам акций и криптовалют.
* Расчет и визуализация корреляционной матрицы между выбранными активами.
* Оптимизация инвестиционного портфеля на основе модели Марковица.
* Автоматическое фоновое обновление данных.
* Веб-интерфейс для отображения данных и взаимодействия с пользователем.

## Технологический стек

* **Бэкенд:** Python, Flask
* **База данных:** PostgreSQL
* **Анализ данных:** Pandas, NumPy, SciPy
* **Сбор данных:** yfinance, Tinkoff Invest API
* **Фоновые задачи:** APScheduler
* **Оркестровка:** Docker, Docker Compose
* **Фронтенд:** HTML, CSS, JavaScript (Возможно, React - укажите, если используется)
* **WSGI Сервер:** Gunicorn (для Docker)

## Предварительные требования

Для запуска проекта локально с использованием Docker необходимо установить:

* [Docker Engine](https://docs.docker.com/engine/install/)
* [Docker Compose](https://docs.docker.com/compose/install/) (обычно идет вместе с Docker Desktop для Windows/Mac)

## Установка и запуск

1.  **Клонируйте репозиторий:**
    ```bash
    git clone <URL вашего репозитория>
    cd <папка вашего репозитория>
    ```

2.  **Создайте файл `.env`:**
    Скопируйте файл `.env.example` (если вы его создали) или создайте `.env` вручную в корневой папке проекта. Заполните необходимые переменные окружения:
    ```dotenv
    # Переменные для подключения к PostgreSQL
    # Используйте те же значения, что и в вашем коде (os.getenv) или новые
    PG_USER=postgres
    PG_PASS=aviasales
    PG_HOST=db # Это значение используется ТОЛЬКО приложением внутри Docker, не меняйте
    PG_PORT=5432
    PG_DB=my_db
    
    # Секретный ключ Flask (сгенерируйте случайную строку)
    # python -c 'import secrets; print(secrets.token_hex(16))'
    SECRET_KEY=ваш_очень_секретный_ключ_flask
    
    # API Токен Tinkoff
    TOKEN="<Вставьте ваш токен из Т-инвестиций>"
    
    # Другие переменные окружения, если нужны
    FLASK_ENV=development
    ```
    **Важно:** Добавьте `.env` в ваш `.gitignore` файл!

3.  **Соберите и запустите контейнеры:**
    Выполните в терминале в корневой папке проекта:
    ```bash
    docker-compose up --build -d
    ```
    * `--build`: Пересобрать образы при первом запуске или если были изменения в `Dockerfile` или коде.
    * `-d`: Запустить контейнеры в фоновом режиме.

    При первом запуске может потребоваться некоторое время для загрузки образов и установки зависимостей.

## Использование

* **Веб-интерфейс:** Откройте веб-браузер и перейдите по адресу `http://127.0.0.1:5050` (или другой порт, если вы изменили его в `docker-compose.yml`).
* **Доступ к базе данных (через pgAdmin или другой клиент):**
    * Хост: `localhost`
    * Порт: `5433` (или другой порт, если вы изменили его для сервиса `db` в `docker-compose.yml`)
    * Имя пользователя: Значение `PG_USER` из вашего `.env` файла (например, `postgres`)
    * Пароль: Значение `PG_PASS` из вашего `.env` файла
    * Имя БД: Значение `PG_DB` из вашего `.env` файла (например, `my_db`)

## Остановка приложения

Чтобы остановить запущенные контейнеры:

```bash
docker-compose down
```

Чтобы остановить контейнеры и удалить том с данными БД ( **Внимание! Данные будут потеряны!**):

```bash
docker-compose down -v
```

## Структура проекта

```
.
├── app/                  # Основной код приложения Flask
│   ├── data/             # Модули сбора данных
│   ├── models/           # Модели SQLAlchemy и логика работы с БД/расчетов
│   ├── routes/           # Маршруты Flask (контроллеры)
│   ├── services/         # Взаимодействие с внешними сервисами (Tinkoff API)
│   ├── static/           # Статические файлы (CSS, JS, изображения)
│   ├── templates/        # HTML-шаблоны Jinja2
│   ├── utils/            # Вспомогательные утилиты
│   └── __init__.py       # Фабрика приложения Flask
├── tests/                # (Опционально) Автоматические тесты
├── .env                  # Переменные окружения
├── .gitignore            # Файлы, игнорируемые Git
├── Dockerfile            # Инструкции по сборке образа Flask-приложения
├── docker-compose.yml    # Конфигурация для запуска мультиконтейнерного приложения
├── requirements.txt      # Зависимости Python
├── apps.py                # Точка входа для запуска Flask-приложения (или manage.py)
└── README.md             # Этот файл
```
